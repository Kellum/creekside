---
interface Props {
  question: string;
  answer: string;
  index: number;
}

const { question, answer, index } = Astro.props;
const id = `faq-${index}`;
---

<div class="border-b border-gray-200 py-4">
  <button
    class="faq-button w-full flex justify-between items-center text-left gap-4 group"
    aria-expanded="false"
    aria-controls={id}
  >
    <span class="text-lg font-semibold text-gray-900 group-hover:text-primary transition-colors">
      {question}
    </span>
    <svg
      class="faq-icon w-6 h-6 text-primary transition-transform duration-300 flex-shrink-0"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
    >
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
    </svg>
  </button>
  <div
    id={id}
    class="faq-answer overflow-hidden transition-all duration-300 ease-in-out"
    style="max-height: 0; opacity: 0;"
  >
    <div class="pt-4 text-gray-600 leading-relaxed">
      {answer}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const buttons = document.querySelectorAll('.faq-button');

    buttons.forEach((button) => {
      button.addEventListener('click', () => {
        const answer = button.nextElementSibling as HTMLElement;
        const answerContent = answer.querySelector('div') as HTMLElement;
        const icon = button.querySelector('.faq-icon') as HTMLElement;
        const isExpanded = button.getAttribute('aria-expanded') === 'true';

        // Toggle current FAQ
        if (isExpanded) {
          // Close
          button.setAttribute('aria-expanded', 'false');
          answer.style.maxHeight = '0';
          answer.style.opacity = '0';
          icon.style.transform = 'rotate(0deg)';
        } else {
          // Open
          button.setAttribute('aria-expanded', 'true');
          answer.style.maxHeight = answerContent.scrollHeight + 'px';
          answer.style.opacity = '1';
          icon.style.transform = 'rotate(180deg)';
        }
      });
    });
  });
</script>
